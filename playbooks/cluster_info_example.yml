---
# Example playbook demonstrating cluster information gathering with nvidia.bcm collection

- name: BCM Cluster Information Examples
  hosts: localhost
  connection: local
  gather_facts: false

  tasks:
    - name: Gather all BCM cluster facts
      nvidia.bcm.bcm_info:
      register: bcm_facts

    - name: Display cluster summary
      debug:
        msg: |
          === NVIDIA BCM Cluster Summary ===
          Devices: {{ bcm_facts.bcm.counts.devices }}
          Users: {{ bcm_facts.bcm.counts.users }}
          Groups: {{ bcm_facts.bcm.counts.groups }}
          Categories: {{ bcm_facts.bcm.counts.categories }}
          Software Images: {{ bcm_facts.bcm.counts.software_images }}
          Networks: {{ bcm_facts.bcm.counts.networks }}
          Partitions: {{ bcm_facts.bcm.counts.partitions }}
          Racks: {{ bcm_facts.bcm.counts.racks }}

    - name: Display device inventory
      debug:
        msg: "{{ item.name }} ({{ item.type }}) - MAC: {{ item.mac }}"
      loop: "{{ bcm_facts.bcm.devices }}"

    - name: Display network configuration
      debug:
        msg: "{{ item.name }} - Domain: {{ item.domain }}, MTU: {{ item.mtu }}"
      loop: "{{ bcm_facts.bcm.networks }}"

    - name: Gather only entity counts
      nvidia.bcm.bcm_info:
        gather_subset:
          - counts
      register: counts_only

    - name: Show counts
      debug:
        var: counts_only.bcm.counts
